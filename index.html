<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema Pós-Obra</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-compat.js"></script>
  <style>
    body {
      padding: 2rem;
      background: linear-gradient(to right, #4e54c8, #8f94fb);
      color: #333;
    }
    .card {
      margin-bottom: 1rem;
    }
    .hidden {
      display: none;
    }
    .login-container {
      max-width: 400px;
      margin: 4rem auto;
      background: #fff;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <!-- Tela de Login Isolada -->
  <div id="loginView" class="login-container">
    <div class="text-center mb-4">
      <img src="https://img.icons8.com/ios-filled/50/4e54c8/construction.png"/>
      <h3 class="mt-2">Sistema Pós-Obra</h3>
      <p class="text-muted">Faça login para acessar o sistema</p>
    </div>
    <input id="loginEmail" type="email" class="form-control mb-2" placeholder="E-mail">
    <input id="loginSenha" type="password" class="form-control mb-3" placeholder="Sua senha">
    <button class="btn btn-primary w-100" onclick="fazerLogin()">
      <i class="bi bi-box-arrow-in-right"></i> Entrar
    </button>
    <div class="alert alert-light mt-3 text-center small">
      <strong>Credenciais de teste:</strong><br>
      Admin: admin@admin.com / admin123<br>
      Usuário: usuario@teste.com / 123456
    </div>
  </div>

  <!-- Área protegida do sistema -->
  <div id="appView" class="container hidden">
    <h1 class="mb-4">Painel do Sistema</h1>

    <!-- Cadastro de Usuário -->
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Cadastrar Usuário</h5>
        <input id="userNome" class="form-control mb-2" placeholder="Nome">
        <input id="userEmail" class="form-control mb-2" placeholder="E-mail">
        <input id="userSenha" class="form-control mb-2" placeholder="Senha">
        <input id="userTelefone" class="form-control mb-2" placeholder="Telefone">
        <button class="btn btn-primary" onclick="cadastrarUsuario()">Cadastrar</button>
      </div>
    </div>

    <!-- Cadastro de Obra -->
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Cadastrar Obra</h5>
        <input id="obraNome" class="form-control mb-2" placeholder="Nome da Obra">
        <input id="obraResponsavel" class="form-control mb-2" placeholder="Responsável">
        <input id="obraEndereco" class="form-control mb-2" placeholder="Endereço">
        <input id="obraInicio" type="date" class="form-control mb-2">
        <input id="obraFim" type="date" class="form-control mb-2">
        <textarea id="obraDescricao" class="form-control mb-2" placeholder="Descrição"></textarea>
        <button class="btn btn-primary" onclick="cadastrarObra()">Cadastrar</button>
      </div>
    </div>

    <!-- Cadastro de Manutenção -->
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Cadastrar Manutenção</h5>
        <input id="manutencaoObraId" class="form-control mb-2" placeholder="ID da Obra">
        <input id="manutencaoTitulo" class="form-control mb-2" placeholder="Título">
        <input id="manutencaoData" type="date" class="form-control mb-2">
        <select id="manutencaoPrioridade" class="form-control mb-2">
          <option value="baixa">Baixa</option>
          <option value="media">Média</option>
          <option value="alta">Alta</option>
        </select>
        <textarea id="manutencaoDescricao" class="form-control mb-2" placeholder="Descrição"></textarea>
        <button class="btn btn-primary" onclick="cadastrarManutencao()">Cadastrar</button>
      </div>
    </div>

    <!-- Cadastro Linha do Tempo -->
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Cadastrar Evento da Obra</h5>
        <input id="eventoObraId" class="form-control mb-2" placeholder="ID da Obra">
        <input id="eventoTitulo" class="form-control mb-2" placeholder="Título do Evento">
        <input id="eventoData" type="date" class="form-control mb-2">
        <textarea id="eventoDescricao" class="form-control mb-2" placeholder="Descrição do Evento"></textarea>
        <button class="btn btn-primary" onclick="cadastrarEvento()">Cadastrar</button>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const firebaseConfig = {
        apiKey: "AIzaSyAc81JPqeLu2ssy-kGG0CEb_3BgqMJ5sJ4",
        authDomain: "site-pos-obra.firebaseapp.com",
        databaseURL: "https://site-pos-obra-default-rtdb.firebaseio.com",
        projectId: "site-pos-obra",
        storageBucket: "site-pos-obra.firebasestorage.app",
        messagingSenderId: "325132739782",
        appId: "1:325132739782:web:ee9981b80d1a673169a3c7",
        measurementId: "G-XB7SC26WE0"
      };

      firebase.initializeApp(firebaseConfig);
      const db = firebase.database();

      // login falso local (simulação)
      window.fazerLogin = function () {
        const email = document.getElementById("loginEmail").value;
        const senha = document.getElementById("loginSenha").value;

        if ((email === "admin@admin.com" && senha === "admin123") ||
            (email === "usuario@teste.com" && senha === "123456")) {
          document.getElementById("loginView").classList.add("hidden");
          document.getElementById("appView").classList.remove("hidden");
        } else {
          alert("Credenciais inválidas.");
        }
      }

      window.cadastrarUsuario = function () {
        const usuario = {
          id: 'user-' + Date.now(),
          nome: document.getElementById("userNome").value,
          email: document.getElementById("userEmail").value,
          senha: document.getElementById("userSenha").value,
          telefone: document.getElementById("userTelefone").value,
          tipo: "usuario",
          ativo: true,
          dataCadastro: new Date().toISOString()
        };
        db.ref('usuarios').push(usuario);
      }

      window.cadastrarObra = function () {
        const obra = {
          id: 'obra-' + Date.now(),
          nome: document.getElementById("obraNome").value,
          responsavel: document.getElementById("obraResponsavel").value,
          endereco: document.getElementById("obraEndereco").value,
          dataInicio: document.getElementById("obraInicio").value,
          dataConclusao: document.getElementById("obraFim").value,
          descricao: document.getElementById("obraDescricao").value,
          dataCadastro: new Date().toISOString()
        };
        db.ref('obras').push(obra);
      }

      window.cadastrarManutencao = function () {
        const manutencao = {
          id: 'man-' + Date.now(),
          obraId: document.getElementById("manutencaoObraId").value,
          titulo: document.getElementById("manutencaoTitulo").value,
          descricao: document.getElementById("manutencaoDescricao").value,
          data: document.getElementById("manutencaoData").value,
          prioridade: document.getElementById("manutencaoPrioridade").value,
          status: "pendente",
          dataCadastro: new Date().toISOString()
        };
        db.ref('manutencoes').push(manutencao);
      }

      window.cadastrarEvento = function () {
        const evento = {
          id: 'event-' + Date.now(),
          obraId: document.getElementById("eventoObraId").value,
          titulo: document.getElementById("eventoTitulo").value,
          data: document.getElementById("eventoData").value,
          descricao: document.getElementById("eventoDescricao").value,
          dataCadastro: new Date().toISOString()
        };
        db.ref('eventos').push(evento);
      }
    });
  </script>
</body>
</html>


